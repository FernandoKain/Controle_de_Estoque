<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Controle de Estoque</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <style>
    .alerta-estoque {
      background-color: #ffcccc;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container mt-5">
    <h1 class="text-center mb-4">üì¶ Controle de Estoque</h1>

    <!-- Links de navega√ß√£o -->
    <div class="mb-4 d-flex justify-content-between">
      <div>
        <a href="/movimentar" class="btn btn-secondary">Entrada/Sa√≠da</a>
        <a href="/relatorio" class="btn btn-secondary">Relat√≥rio</a>
      </div>
      <a href="/logout" class="btn btn-danger">Sair</a>
    </div>

    <!-- Formul√°rio de busca -->
    <form class="input-group mb-4" method="GET" action="/">
      <input type="text" name="busca" class="form-control" placeholder="Buscar por nome ou categoria">
      <button class="btn btn-outline-primary" type="submit">Buscar</button>
      <a href="/" class="btn btn-outline-secondary">Limpar</a>
    </form>

    <!-- Formul√°rio de adicionar produto -->
    <div class="card p-4 mb-4">
      <h5>Adicionar Produto</h5>
      <form action="/add" method="POST" class="row g-2">
        <div class="col-md-3">
          <input type="text" name="nome" class="form-control" placeholder="Nome" required>
        </div>
        <div class="col-md-2">
          <input type="text" name="categoria" class="form-control" placeholder="Categoria">
        </div>
        <div class="col-md-2">
          <input type="number" name="quantidade" class="form-control" placeholder="Quantidade" required>
        </div>
        <div class="col-md-2">
          <input type="number" name="preco" class="form-control" step="0.01" placeholder="Pre√ßo" required>
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-success w-100">Adicionar</button>
        </div>
      </form>
    </div>

    <!-- Tabela de produtos -->
    <div class="table-responsive">
      <table class="table table-bordered table-striped table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>Categoria</th>
            <th>Quantidade</th>
            <th>Pre√ßo</th>
            <th>A√ß√µes</th>
          </tr>
        </thead>
        <tbody>
          {% for p in produtos %}
          <tr class="{% if p.quantidade <= p.estoque_minimo %}table-danger{% endif %}">
            <td>{{ p.id }}</td>
            <td>{{ p.nome }}</td>
            <td>{{ p.categoria }}</td>
            <td>{{ p.quantidade }}</td>
            <td>R$ {{ p.preco }}</td>
            <td>
              <a href="/edit/{{ p.id }}" class="btn btn-sm btn-primary">Editar</a>
              <a href="/delete/{{ p.id }}" class="btn btn-sm btn-danger"
                 onclick="return confirm('Deseja mesmo excluir este produto?');">Excluir</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</body>

</html>
